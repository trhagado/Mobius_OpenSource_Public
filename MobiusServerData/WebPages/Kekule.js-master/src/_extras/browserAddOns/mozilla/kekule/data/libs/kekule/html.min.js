(function(){var g=window;if(!g.Kekule){Kekule={}}Kekule.Browser={IE:!!(window.attachEvent&&!window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),language:navigator.language||navigator.browserLanguage};Kekule.BrowserFeature={typedArray:(typeof(ArrayBuffer)!=="undefined"),svg:!!window.SVGSVGElement,canvas:!!window.CanvasRenderingContext2D,webgl:(function(){try{var l=document.createElement("canvas");return !!window.WebGLRenderingContext&&(l.getContext("webgl")||l.getContext("experimental-webgl"))}catch(m){return false}})(),workers:!!window.Worker,fileapi:!!(window.File&&window.FileReader&&window.FileList&&window.Blob),sessionStorage:!!window.sessionStorage,localStorage:!!window.localStorage,cssTransition:(function(l){return"transition" in l||"WebkitTransition" in l||"MozTransition" in l||"msTransition" in l||"OTransition" in l})(document.createElement("div").style),cssTranform:(function(l){return"transform" in l||"WebkitTransform" in l||"MozTransform" in l||"msTransform" in l||"OTransform" in l})(document.createElement("div").style),html5Form:{placeholder:(function(l){return"placeholder" in l})(document.createElement("input")),supportType:function(m){var n=document.createElement("input");n.setAttribute("type",m);var l=n.type===m;var p=["text","url","search"];if(l&&(p.indexOf(m.toLowerCase())<0)){var o=":)";n.value=o;l=n.value!==o}return l}},mutationObserver:window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver};Kekule.X={};var a=Kekule.X;var i=function(l){return((l===null)||(typeof(l)==="undefined"))};var h=function(l){return !i(l)};var j=function(l){var m=window.getComputedStyle?window.getComputedStyle(l,null).position:l.currentStyle?l.currentStyle.position:null;if(!m){return false}else{if(!m){return false}else{m=m.toString().toLowerCase();return(m==="relative")||(m==="absolute")}}};a.MutationObserver=window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver;a.Event={MOUSE_BTN_LEFT:0,MOUSE_BTN_RIGHT:2,MOUSE_BTN_MID:1,MOUSE_BTN_LR:3};a.Event.MouseButton={LEFT:0,RIGHT:2,MID:1,LR:3};a.Event.KeyCode={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRTSC:44,INS:45,DEL:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145};a.Event.isSupported=(function(){var l={};return function(n){var p={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img",unload:"win",resize:"win"},q=n.replace(/^on/,"");if(l[q]){return l[q]}var o=p[q]=="win"?window:document.createElement(p[q]||"div");n="on"+q;var m=(n in o);if(!m){o.setAttribute(n,"return;");m=typeof o[n]=="function"}o=null;l[q]=m;return m}})();a.Event.Methods={getType:function(l){return l.__$type__||l.type},getTarget:function(l){var m=l.target||l.srcElement;if(m.nodeType==3){m=m.parentNode}return m},getCurrentTarget:function(l){return l.currentTarget},getEventPhase:function(l){return l.eventPhase},getAltKey:function(l){return l.altKey},getCtrlKey:function(l){return l.ctrlKey},getShiftKey:function(l){return l.shiftKey},getCharCode:function(l){return h(l.charCode)?l.charCode:l.keyCode},getKeyCode:function(l){return l.keyCode},getClientX:function(m){var l;if(m.touches){var n=m.touches[0];l=n&&n.clientX}else{l=m.clientX}return l},getClientY:function(m){var l;if(m.touches){var n=m.touches[0];l=n&&n.clientY}else{l=m.clientY}return l},getScreenX:function(m){var l;if(m.touches){var n=m.touches[0];l=n&&n.screenX}else{l=m.screenX}return l},getScreenY:function(m){var l;if(m.touches){var n=m.touches[0];l=n&&n.screenY}else{l=m.screenY}return l},getPageX:function(m){if(m.touches){var o=m.touches[0];if(o&&h(o.pageX)){return o.pageX}}else{if(h(m.pageX)){return m.pageX}}var n=a.Event.getTarget(m).ownerDocument||a.Event.getTarget(m);var l=n?n.body:null;return a.Event.getClientX(m)+(n&&n.scrollLeft||l&&l.scrollLeft||0)-(n&&n.clientLeft||l&&l.clientLeft||0)},getPageY:function(m){if(m.touches){var o=m.touches[0];if(o&&h(o.pageY)){return o.pageY}}else{if(h(m.pageY)){return m.pageY}}var n=a.Event.getTarget(m).ownerDocument||a.Event.getTarget(m);var l=n?n.body:null;return a.Event.getClientY(m)+(n&&n.scrollTop||l&&l.scrollTop||0)-(n&&n.clientTop||l&&l.clientTop||0)},getOffsetX:function(n){if(h(n.offsetX)){return n.offsetX}else{var m=a.Event.getTarget(n);if(m.defaultView&&m.body){m=m.body}if(h(n.layerX)&&j(m)&&!n.touches){return n.layerX}else{var l=a.Event.getClientX(n);return Math.round(l-m.getBoundingClientRect().left)}}},getOffsetY:function(n){if(h(n.offsetY)){return n.offsetY}else{var m=a.Event.getTarget(n);if(m.defaultView&&m.body){m=m.body}if(h(n.layerY)&&j(m)&&!n.touches){return n.layerY}else{var l=a.Event.getClientY(n);return Math.round(l-m.getBoundingClientRect().top)}}},getWindowX:function(m){var l=a.Event.getPageX(m);var o=m.target.ownerDocument||m.target;var n=o&&o.defaultView;var p=(n&&n.scrollX)||0;return l-p},getWindowY:function(l){var p=a.Event.getPageY(l);var n=l.target.ownerDocument||l.target;var m=n&&n.defaultView;var o=(m&&m.scrollY)||0;return p-o},getRelXToCurrTarget:function(n){var m=a.Event.getCurrentTarget(n);if(m.defaultView&&m.body){m=m.body}var l=a.Event.getClientX(n);return Math.round(l-m.getBoundingClientRect().left)},getRelYToCurrTarget:function(n){var m=a.Event.getCurrentTarget(n);if(m.defaultView&&m.body){m=m.body}var l=a.Event.getClientY(n);return Math.round(l-m.getBoundingClientRect().top)},getTouches:function(l){return l.touches}};a.Event._MouseEventEx={isMouseEnterLeaveEvent:function(l){return(l==="mouseenter")||(l==="mouseleave")},addMouseEnterLeaveListener:function(p,o,q,l){var n=((o==="mouseenter")&&a.Event.isSupported("mouseenter"))||((o==="mouseleave")&&a.Event.isSupported("mouseleave"));if(n){return p.addEventListener(o,q,l)}else{var r=function(w){var v=w.getTarget?w.getTarget():w.target;var s=w.getCurrentTarget?w.getCurrentTarget():w.currentTarget;if((v===s)||(Kekule.DomUtils.isDescendantOf(v,s))){var u=w.getRelatedTarget?w.getRelatedTarget():w.relatedTarget;if((!u)||(!Kekule.DomUtils.isDescendantOf(u,s))){var t=new MouseEvent(o,{view:window,bubbles:false,cancelable:true,target:s,currentTarget:s,relatedTarget:u});q.call(s,t)}}};q.__$mouseExListenerWrapper__=r;var m=(o==="mouseenter")?"mouseover":"mouseout";return p.addEventListener(m,r,l)}},removeMouseEnterLeaveListener:function(o,n,p){var m=((n==="mouseenter")&&a.Event.isSupported("mouseenter"))||((n==="mouseleave")&&a.Event.isSupported("mouseleave"));if(m){return o.removeEventListener(n,p,useCapture)}else{var l=(n==="mouseenter")?"mouseover":"mouseout";return o.removeEventListener(l,p.__$mouseExListenerWrapper__||p)}}};a.Event._W3C={addListener:function(n,m,o,l){if(a.Event._MouseEventEx.isMouseEnterLeaveEvent(m)){return a.Event._MouseEventEx.addMouseEnterLeaveListener(n,m,o,l)}else{return n.addEventListener(m,o,l)}},removeListener:function(n,m,o,l){if(a.Event._MouseEventEx.isMouseEnterLeaveEvent(m)&&o.__$listenerWrapper__){return a.Event._MouseEventEx.removeMouseEnterLeaveListener(n,m,o.__$listenerWrapper__)}else{return n.removeEventListener(m,o,l)}},stopPropagation:function(l){l.stopPropagation()},preventDefault:function(l){l.preventDefault()}};a.Event._W3CMethods={getRelatedTarget:function(l){return l.relatedTarget},getButton:function(l){return l.button}};a.Event._Gecko={addListener:function(n,m,o,l){if(a.Event._MouseEventEx.isMouseEnterLeaveEvent(m)){return a.Event._MouseEventEx.addMouseEnterLeaveListener(n,m,o,l)}if((m==="mousewheel")){var p=function(q){q.wheelDeltaY=q.wheelDelta=-q.detail*40;q.__$type__="mousewheel";o.call(n,q)};o.__$mousewheelListenerWrapper__=p;n.addEventListener("DOMMouseScroll",p,l)}else{n.addEventListener(m,o,l)}},removeListener:function(n,m,o,l){if((m==="mousewheel")&&o.__$mousewheelListenerWrapper__){n.removeEventListener("DOMMouseScroll",o.__$mousewheelListenerWrapper__,l)}else{n.removeEventListener(m,o,l)}}};a.Event._IE={_handlers:{},WIN_UNLOAD_FLAG_FIELD:"__$win_unload_linked__",addListener:function(n,m,o,l){if(a.Event.findHandlerIndex(n,m,o)>=0){return}var r=(function(s){if(!s){s=window.event}s.currentTarget=n;s.eventPhase=(s.srcElement===n)?2:3;if(!c){Object.extend(s,f)}o.call(n,s)});n.attachEvent(a.Event.getEventName(m),r);a.Event.registerHandler(n,m,o,r);var q=n.ownerDocument||n;var p=q.parentWindow||q;a.Event._linkUnloadEvent(p)},removeListener:function(o,n,p,l){var m=a.Event.findHandlerIndex(o,n,p);if(m>=0){var q=a.Event._handlers[n][m].wrapper;o.detachEvent(a.Event.getEventName(n),q);a.Event._handlers[n].splice(m,1)}},stopPropagation:function(l){l.cancelBubble=true},preventDefault:function(l){l.returnValue=false},removeAllListeners:function(q){var r=a.Event._handlers;if(!r){return}for(var p in r){if(r.hasOwnProperty(p)){var n=r[p];if(n&&n.length){var l=a.Event.getEventName(p);for(var m=n.length-1;m>=0;--m){var o=n[m];if((!q)||(o.element.ownerDocument===q)){o.element.detachEvent(l,o.wrapper);n.splice(m,1)}}}}}},getEventName:function(l){return"on"+l},registerHandler:function(o,n,p,q){var l=a.Event._handlers;if(!l[n]){l[n]=[]}var m=l[n];m.push({element:o,handler:p,wrapper:q})},unregisterHandler:function(o,n,p){if(!handlers[n]){return}var m=handlers[n];var l=a.Event.findHandlerIndex(o,n,p);if(l>=0){m.splice(l,1)}},findHandlerIndex:function(q,p,s){var o=a.Event._handlers[p];if(!o){return -1}for(var n=0,m=o.length;n<m;++n){var r=o[n];if((r.element===q)&&(r.handler===s)){return n}}return -1},_linkUnloadEvent:function(l){var m=a.Event.WIN_UNLOAD_FLAG_FIELD;if(l[m]){return}else{l.attachEvent("onunload",a.Event.reactWinUnload);l[m]=true}},reactWinUnload:function(){var l=this.ownerDocument;a.Event.removeAllListeners(l)}};a.Event._IEMethods={getRelatedTarget:function(l){return l.fromElement||l.toElement},getButton:function(l){switch(l.button){case 1:return 0;case 2:return 2;case 4:return 1;case 3:return 3;default:return l.button}},stopPropagation:function(l){l.cancelBubble=true},preventDefault:function(l){l.returnValue=false}};if(document.addEventListener){a.Event=Object.extend(a.Event,a.Event._W3C);a.Event.Methods=Object.extend(a.Event.Methods,a.Event._W3CMethods);if(Kekule.Browser.Gecko){a.Event=Object.extend(a.Event,a.Event._Gecko)}}else{if(document.attachEvent){a.Event=Object.extend(a.Event,a.Event._IE);a.Event.Methods=Object.extend(a.Event.Methods,a.Event._IEMethods);if(window.Element){var e=window.Element.prototype;e.addEventListener=a.Event.addListener.methodize();e.removeEventListener=a.Event.removeListener.methodize()}}}Object.extend(a.Event,a.Event.Methods);var d=null;if(window.Event){d=window.Event.prototype}if(!d){if(document.createEvent){d=document.createEvent("HTMLEvents").__proto__}}var c=!!d;var f={};var b=a.Event.Methods;for(name in b){if(b.hasOwnProperty(name)&&(typeof(b[name])==="function")){f[name]=b[name].methodize()}}if(d){Object.extend(d,f)}a.Ajax={XMLHttpFactories:[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],_availableFactoryIndex:-1,createXMLHTTPObject:function(){var n=false;var o=a.Ajax.XMLHttpFactories;var l=a.Ajax._availableFactoryIndex;if(l>=0){n=o[l]()}else{for(var m=0;m<o.length;m++){try{n=o[m]();a.Ajax._availableFactoryIndex=m}catch(p){continue}break}}return n},sendRequest:function(n,u,p,r,o){var m=false;var q=true;var t=a.Ajax.createXMLHTTPObject();if(!t){return}var l=(p)?"POST":"GET";t.open(l,n,true);t.setRequestHeader("User-Agent","XMLHTTP/1.0");if(p){t.setRequestHeader("Content-type","application/x-www-form-urlencoded")}if(r){try{t.responseType=r}catch(s){}if((r==="arraybuffer")||(r==="blob")){m=true}if(t.responseType!==r){q=false}}if(m&&(!q)&t.overwriteMimeType){t.overrideMimeType("text/plain; charset=x-user-defined")}if(o&&t.overwriteMimeType){t.overwriteMimeType(o)}t.onreadystatechange=function(){if(t.readyState!=4){return}if(t.status!=200&&t.status!=304){u(null,t,false);throw"HTTP error "+t.status;return}u(t.response||t.responseText,t,true)};if(t.readyState==4){return}t.send(p)},getResponseMimeType:function(l){return l.getResponseHeader("content-type")||""}};Kekule.Ajax=Kekule.X.Ajax;Kekule.X.DomReady={isReady:false,funcs:[],domReady:function(m){k.initReady();if(!k.isReady){var l=document&&document.readyState;if(l==="complete"||l==="loaded"||l==="interactive"){k.isReady=true}}if(k.isReady){m()}else{k.funcs.push(m)}},fireReady:function(){if(k.isReady){return}k.isReady=true;for(var n=0,m=k.funcs.length;n<m;++n){var o=k.funcs[n];o()}k.funcs.length=0},initReady:function(){if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);k.fireReady()},false)}else{if(document.getElementById){document.write('<script id="ie-domReady" defer="defer" src="//:"><\/script>');document.getElementById("ie-domReady").onreadystatechange=function(){if(this.readyState==="complete"){k.fireReady();this.onreadystatechange=null;this.parentNode.removeChild(this)}}}}}};var k=Kekule.X.DomReady;Kekule.X.domReady=k.domReady})();(function(){Kekule.NativeServices={MODE_OPEN:"open",MODE_SAVE:"save",showFilePickerDialog:function(c,d,b){if(Kekule.NativeServices.doShowFilePickerDialog){return Kekule.NativeServices.doShowFilePickerDialog(c,d,b)}},canLoadFileData:function(b){return !!a.doLoadFileData||!!a.doShowFilePickerDialog},loadFileData:function(e,f,c){if(Kekule.NativeServices.doLoadFileData){return Kekule.NativeServices.doLoadFileData(e,f,c)}var d=Object.create(c||{});d.multiple=false;d.mode=a.MODE_OPEN;var b=function(h,i,j){if(!h||!i){f(h,null,null)}else{if(Kekule.BrowserFeature.fileapi){var l=i.name;var k=d.binaryDetector&&d.binaryDetector(l,i);var g=new FileReader();g.onload=function(n){var m=g.result;if(f){f(true,m,l)}};g.onerror=function(){if(f){f(false)}Kekule.error(Kekule.$L("ErrorMsg.ERROR_LOADING_FILE"+l))};if(k){g.readAsArrayBuffer(i)}else{g.readAsText(i)}}else{Kekule.error(Kekule.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"))}}};a.showFilePickerDialog(e,b,d)},canSaveFileData:function(b){return !!a.doSaveFileData},saveFileData:function(d,c,e,b){if(Kekule.NativeServices.doSaveFileData){return Kekule.NativeServices.doSaveFileData(d,c,e,b)}}};var a=Kekule.NativeServices;Kekule.HtmlNativeServiceImpl={doShowFilePickerDialog:function(d,e,b){var c=Kekule.HtmlNativeServiceImpl._createFileInputElem(d,e,b||{});c.click()},_createFileInputElem:function(k,m,n){var o=k.createElement("input");o.setAttribute("type","file");var c=n||{};if(c.multiple){o.setAttribute("multiple","multiple")}if(c.filters){var d=[];for(var g=0,f=c.filters.length;g<f;++g){var e=c.filters[g];if(e.filter){d.push(e.filter)}}var j=d.join(",");o.setAttribute("accept",j)}var b=o.style;b.position="absolute";b.left="-100000px";b.opacity=0;k.body.appendChild(o);var h=function(q){var p=q.getTarget();var l=p.files;var i=l&&l[0];if(m){m(true,i,l)}Kekule.X.Event.removeListener(p,"change",h);p.ownerDocument.body.focus();if(p.parentNode){p.parentNode.removeChild(p)}};Kekule.X.Event.addListener(o,"change",h);return o},doSaveFileData:function(e,d,f,c){var b=Kekule.HtmlNativeServiceImpl._createDataElem(e,d,c.initialFileName||null);b.click();b.parentNode.removeChild(b);if(f){f(null,null)}},_createDataElem:function(f,e,g){var c=f.createElement("a");var d="data:application/octet-stream,"+encodeURIComponent(e);c.setAttribute("href",d);c.setAttribute("download",g||"");var b=c.style;c.position="absolute";c.left="-100000px";c.opacity=0;f.body.appendChild(c);return c}};if(Kekule.BrowserFeature.fileapi){a.doShowFilePickerDialog=Kekule.HtmlNativeServiceImpl.doShowFilePickerDialog;a.doSaveFileData=Kekule.HtmlNativeServiceImpl.doSaveFileData}})();Kekule.PredefinedResLoader=Class.create(ObjectEx,{CLASS_NAME:"Kekule.PredefinedResLoader",initialize:function($super,c,b,a){$super();if(!b){Kekule.Error(Kekule.$L("ErrorMsg.EMPTY_RESURI"))}else{this.setPropStoreFieldValue("resUri",b);this.setDoc(c);if(a){this.setResType(a)}}},initProperties:function(){this.defineProp("doc",{dataType:DataType.OBJECT,serializable:false});this.defineProp("resUri",{dataType:DataType.STRING,serializable:false,setter:null});this.defineProp("resType",{dataType:DataType.STRING,serializable:false})},getLinkedResUrl:function(b){var a=b.tagName.toLowerCase();if(a==="link"){return b.getAttribute("href")}else{if(a==="script"){return b.getAttribute("src")}else{return null}}},getElemResType:function(a){return a.getAttribute("type")},load:function(k){var e=this.getResUri();var h,a;var d=Kekule.PredefinedResReferer.ID_MARK;if(e.startsWith(d)){var c=e.substr(d.length).trim();h=this.getDoc().getElementById(c);if(h){a=this.getLinkedResUrl(h);var j=this.getElemResType(h);if(j){this.setResType(j)}}}else{a=e}var f={resType:this.getResType(),resUri:e};if(a){Kekule.X.Ajax.sendRequest(a,function(o,n,p){if(p){f=Object.extend(f,{data:o,text:n.responseText,success:true});if(!f.resType){f.resType=Kekule.X.Ajax.getResponseMimeType(n);if(f.resType===Kekule.IO.MimeType.OCTSTREAM){var m=Kekule.UrlUtils.extractFileExt(a);if(m){var l=Kekule.IO.DataFormatsManager.findFormat(null,m);if(l){f.resType=l.mimeType}}}}k(f,p)}else{k(f,false)}},null,null,this.getResType()||null)}else{if(h){var i=h.innerHTML;var g=2;var b=i.indexOf("\r\n");if(b<0){b=i.indexOf("\n");g=1}if(b===0){i=i.substring(g)}f=Object.extend(f,{data:i,text:i,resType:f.resType||"text/plain",success:true});k(f,true)}else{k(f,false)}}}});Kekule.PredefinedResReferer={REFER_PATTERN:/^\s*url\((\S+)\)\s*$/,ID_MARK:"#",isResValue:function(a){return Kekule.PredefinedResReferer.isResReferrer(a)},isResReferrer:function(a){return Kekule.PredefinedResReferer.REFER_PATTERN.test(a)},extractReferedValue:function(c){var a=Kekule.PredefinedResReferer.REFER_PATTERN.exec(c);if(a){var b=a[1];if(b){b=Kekule.StrUtils.unquote(b);return b}}return null},loadResource:function(d,g,b,e){if(!e){e=document}var c=Kekule.PredefinedResReferer;var a=c.extractReferedValue(d);var f;f=new Kekule.PredefinedResLoader(e,a);if(f){if(b){f.setResType(b)}f.load(g)}}};